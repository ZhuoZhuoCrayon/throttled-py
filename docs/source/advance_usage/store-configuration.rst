===================
Store Configuration
===================


1) RedisStore
======================

``RedisStore`` is developed based on the Redis API provided by `redis-py <https://github.com/redis/redis-py>`_.

In terms of Redis connection configuration management, the configuration naming of
`django-redis <https://github.com/jazzband/django-redis>`_ is basically used to reduce the learning cost.


.. tab:: Sync

    .. code-block:: python

        from throttled import store

        store.RedisStore(server="redis://127.0.0.1:6379/0", options={"PASSWORD": ""})


.. tab:: Async

    .. code-block:: python

        from throttled.asyncio import store

        store.RedisStore(server="redis://127.0.0.1:6379/0", options={"PASSWORD": ""})

Arguments
-----------

+------------------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+
| ``server``                   | `Standard Redis URL <https://github.com/redis/lettuce/wiki/Redis-URI-and-connection-details#uri-syntax>`_ | ``"redis://localhost:6379/0"`` |
+------------------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+
| ``options``                  | <Options>                                                                                                 | ``{}``                         |
+------------------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+

Options
-----------

+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| Parameter                    | Description                                                                                                                                                                     | Default                                 |
+==============================+=================================================================================================================================================================================+=========================================+
| ``CONNECTION_FACTORY_CLASS`` | ConnectionFactory is used to create and maintain `ConnectionPool <https://redis.readthedocs.io/en/stable/connections.html#redis.connection.ConnectionPool>`_.                   | ``"throttled.store.ConnectionFactory"`` |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``CONNECTION_POOL_CLASS``    | ConnectionPool import path.                                                                                                                                                     | ``"redis.connection.ConnectionPool"``   |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``CONNECTION_POOL_KWARGS``   | `ConnectionPool construction parameters <https://redis.readthedocs.io/en/stable/connections.html#connectionpool>`_.                                                             | ``{}``                                  |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``REDIS_CLIENT_CLASS``       | RedisClient import path, uses `redis.client.Redis <https://redis.readthedocs.io/en/stable/connections.html#redis.Redis>`_ by default.                                           | ``"redis.client.Redis"``                |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``REDIS_CLIENT_KWARGS``      | `RedisClient construction parameters <https://redis.readthedocs.io/en/stable/connections.html#redis.Redis>`_.                                                                   | ``{}``                                  |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``PASSWORD``                 | Password.                                                                                                                                                                       | ``null``                                |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``SOCKET_TIMEOUT``           | ConnectionPool parameters.                                                                                                                                                      | ``null``                                |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``SOCKET_CONNECT_TIMEOUT``   | ConnectionPool parameters.                                                                                                                                                      | ``null``                                |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``SENTINELS``                | ``(host, port)`` tuple list, for sentinel mode, please use ``SentinelConnectionFactory`` and provide this configuration.                                                        | ``[]``                                  |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+
| ``SENTINEL_KWARGS``          | `Sentinel construction parameters <https://redis.readthedocs.io/en/stable/connections.html#id1>`_.                                                                              | ``{}``                                  |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------+


2) MemoryStore
======================

``MemoryStore`` is essentially a memory-based
`LRU Cache <https://en.wikipedia.org/wiki/Cache_replacement_policies#LRU>`_ with expiration time.


.. tab:: Sync

    .. code-block:: python

        from throttled import store

        store.MemoryStore(options={"MAX_SIZE": 10240})

.. tab:: Async

    .. code-block:: python

        from throttled.asyncio import store

        store.MemoryStore(options={"MAX_SIZE": 10240})

Arguments
-----------

+------------------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+
| ``options``                  | <Options>                                                                                                 | ``{}``                         |
+------------------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+

Options
-----------

+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------+----------+
| Parameter    | Description                                                                                                                                      | Default  |
+==============+==================================================================================================================================================+==========+
| ``MAX_SIZE`` | Maximum capacity. When the number of stored key-value pairs exceeds ``MAX_SIZE``, they will be eliminated according to the LRU policy.           | ``1024`` |
+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------+----------+
